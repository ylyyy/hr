@model Entity.major_change
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <link rel="stylesheet" href="../../css/table.css" type="text/css">
    <script src="~/javascript/jquery-1.7.2.js"></script>
    <script src="~/javascript/jquery.unobtrusive-ajax.js"></script>
    <title>Edit</title>
    <script type="text/javascript">

        $(function () {
            $.ajax({
                url: "/transfer/Index1",
                type: "get",
                success: function (data) {
                    for (var i = 0; i < data.length; i++) {
                        var $op = $("<option name='qwe' value='" + data[i].first_kind_id + "'>" + data[i].first_kind_name + "</option>")
                        $("#firstKindId").append($op);
                    }
                    
                }
            })
            $("#firstKindId").change(function () {

                
                $.ajax({
                    url: "/transfer/Index1",
                    type: "get",
                    success: function (data) {
                        for (var i = 0; i < data.length; i++) {
                            var $op = $("<option value='" + data[i].second_kind_id + "'>" + data[i].second_kind_name + "</option>")
                            $("#secondKindId").append($op);
                        }
                    }

                })
            })
            $("#secondKindId").change(function () {
                
                $.ajax({
                    url: "/transfer/Index1",
                    type: "get",
                    success: function (data) {
                        for (var i = 0; i < data.length; i++) {
                            var $op = $("<option value='" + data[i].third_kind_id + "'>" + data[i].third_kind_name + "</option>")
                            $("#thirdKindId").append($op);
                        }
                    }

                })
            })
            $.ajax({
                url: "/transfer/Index1",
                type: "get",
                success: function (data) {
                    for (var i = 0; i < data.length; i++) {
                        var $op = $("<option name='qwe' value='" + data[i].major_kind_id + "'>" + data[i].major_kind_name + "</option>")
                        $("#newMajorKindId").append($op);
                    }
                }
            })
            $("#newMajorKindId").change(function () {
                $.ajax({
                    url: "/transfer/Index1",
                    type: "get",
                    success: function (data) {
                        for (var i = 0; i < data.length; i++) {
                            var $op = $("<option value='" + data[i].major_id + "'>" + data[i].major_name + "</option>")
                            $("#newMajorId").append($op);
                        }
                    }
                })
            })
            $("#newMajorId").change(function () {
                $.ajax({
                    url: "/transfer/Index1",
                    type: "get",
                    success: function (data) {
                        for (var i = 0; i < data.length; i++) {
                            var $op = $("<option value='" + data[i].salary_standard_id + "'>" + data[i].salary_standard_name + "</option>")
                            $("#newSalaryStandardId").append($op);
                        }
                    }
                })
                
            })
            $("#tijiao").click(function () {
                $.ajax({
                    url: "/transfer/Upd",
                    data: $("#SHForm").serialize() + '&' + $.param({ 'FText': $("#firstKindId").find("option:selected").text(), 'SText': $("#secondKindId").find("option:selected").text(), 'TText': $("#thirdKindId").find("option:selected").text(), 'KText': $("#newMajorKindId").find("option:selected").text(), 'MText': $("#newMajorId").find("option:selected").text(), 'SaText': $("#newSalaryStandardId").find("option:selected").text() }),
                    type: "post",
                    success: function (data) {
                        alert("提交成功");
                        if (data == "ok") {

                            alert("提交成功");
                            // window.location.href = "/transfer_locate/successPage";
                        }


                    }


                });
            })
            
            

            //$("#newMajorKindId").change(function () {
                
            //    $.ajax({
            //        url: "/transfer/Index1",
            //        type: "get",
            //        success: function (data) {
            //            for (var i = 0; i < data.length; i++) {
            //                var $op = $("<option value='" + data[i].major_kind_id + "'>" + data[i].major_kind_name + "</option>")
            //                $("#newMajorKindId").append($op);
            //            }
            //        }

            //    })
            //})
        })
    </script>
</head>
<body>
    <form action="" name="ss" id="SHForm">
        <table width="100%">
            <tr>
                <td>
                    <font color="#0000CC">您正在做的业务是:人力资源--调动管理--调动登记</font>
                </td>
            </tr>

            <tr>
                <td align="right">
                    <input type="submit" value="提交" class="BUTTON_STYLE1" id="tijiao" onclick="mySubmit()">
                    <input type="button" class="BUTTON_STYLE1"
                           onclick="javascript:window.history.back();" value="返回">
                </td>
            </tr>
        </table>
        <table width="100%" border="1" cellpadding=0 cellspacing=1
               bordercolorlight=#848284 bordercolordark=#eeeeee
               class="TABLE_STYLE1">
            <tr height="21">
                <td class="TD_STYLE1" width="8%">
                    档案编号
                </td>
                <td class="TD_STYLE2" width="10%">
                    @Html.TextBoxFor(e => e.mch_id, new { @readonly = true })

                </td>
                <td class="TD_STYLE1" width="8%">
                    姓名
                </td>
                <td class="TD_STYLE2" width="10%">
                    @Html.TextBoxFor(e => e.human_name, new { @readonly = true })
                </td>
                <td class="TD_STYLE1" width="8%"></td>
                <td class="TD_STYLE2" width="10%"></td>
                <td class="TD_STYLE1" width="8%"></td>
                <td class="TD_STYLE2" width="10%"></td>
            </tr>
            <tr>

                <td class="TD_STYLE1" width="8%">
                    原一级机构
                </td>
                <td class="TD_STYLE2">
                    @Html.TextBoxFor(e => e.first_kind_name, new { @readonly = true })
                </td>
                <td class="TD_STYLE1" width="8%">
                    原二级机构
                </td>
                <td class="TD_STYLE2" width="10%">
                    @Html.TextBoxFor(e => e.second_kind_name, new { @readonly = true })
                </td>
                <td class="TD_STYLE1" width="8%">
                    原三级机构
                </td>
                <td class="TD_STYLE2" width="10%">
                    @Html.TextBoxFor(e => e.third_kind_name, new { @readonly = true })
                </td>
                <td class="TD_STYLE1" width="8%"></td>
                <td class="TD_STYLE2" width="10%"></td>
            </tr>

            <tr>
                <td class="TD_STYLE1">
                    原职位分类
                </td>
                <td class="TD_STYLE2">
                    @Html.TextBoxFor(e => e.major_kind_name, new { @readonly = true })
                </td>
                <td class="TD_STYLE1" width="12%">
                    原职位名称
                </td>
                <td class="TD_STYLE2">
                    @Html.TextBoxFor(e => e.major_name, new { @readonly = true })
                </td>
                <td class="TD_STYLE1">
                    原薪酬标准
                </td>
                <td class="TD_STYLE2">
                    @Html.TextBoxFor(e => e.salary_standard_name, new { @readonly = true })
                </td>
                <td class="TD_STYLE1">
                    原薪酬总额
                </td>
                <td class="TD_STYLE2">
                    @Html.TextBoxFor(e => e.salary_sum, new { @readonly = true })
                </td>
            </tr>
            <tr>
                <td class="TD_STYLE1">
                    新一级机构名称
                </td>
                <td class="TD_STYLE2">
                    <script type="text/javascript">

                        function mySubmit() {
                            if (document.getElementById("firstKindId").value == '0') {
                                alert("请选择新一级结构！");
                                return;
                            }
                            if (document.getElementById("newMajorKindId").value == '0') {
                                alert("请选择新职位分类！");
                                return;
                            }
                            if (document.getElementById("newMajorId").value == '0') {
                                alert("请选择新职位名称！");
                                return;
                            }
                            if (document.getElementById("newSalaryStandardId").value == '0') {
                                alert("请选择新薪酬标准！");
                                return;
                            }
                            
                            document.forms[0].submit();

                        }
                        $(function () {
                            var first = $("#firstKindId");
                            var second = $("#secondKindId");
                            var third = $("#thirdKindId");
                            first.change(function () {
                                $("#newFirstKindName").val($('#firstKindId option:selected').html());
                                $.post('/HR_Fist/transfer/transferAction!findtwo.action', { 'configThird.firstKindId': $('#firstKindId option:selected').val() },
                                    function (data) {

                                        second.css("width", first.width());
                                        second.empty();
                                        second.append("<option value='0' >-----请选择-----</option>");
                                        var items = $(data).find("item");
                                        items.each(function (i) {
                                            var id = $(items[i]).attr("id");
                                            var name = $(items[i]).attr("name");
                                            second.append("<option value='" + id + "'>" + name + "</option>");


                                        });
                                    }, 'xml');
                                third.val('0');

                            });
                        });
                    </script>

                    <select style="width:160px" name="majorChange.newFirstKindId" id="firstKindId" size="1" class="SELECT_STYLE2">
                        <option value="0">-----请选择-----</option>


                    </select>
                    <input type="hidden" name="majorChange.newFirstKindName" id="newFirstKindName">
                </td>
                <td class="TD_STYLE1" width="12%">
                    新二级机构名称
                </td>
                <td class="TD_STYLE2">
                    <script type="text/javascript">

                        $(function () {

                            var first = $("#firstKindId");
                            var second = $("#secondKindId");
                            var third = $("#thirdKindId");
                            third.change(function () { $("#newThirdKindName").val($('#thirdKindId option:selected').html()); });
                            second.change(function () {
                                $("#newSecondKindName").val($('#secondKindId option:selected').html());
                                $.post('/HR_Fist/transfer/transferAction!findthree.action', { 'configThird.firstKindId': $('#firstKindId option:selected').val(), 'configThird.secondKindId': $('#secondKindId option:selected').val() },
                                    function (data) {
                                        third.css("width", second.width());
                                        third.empty();
                                        third.append("<option value='0' >-----请选择-----</option>");
                                        var items = $(data).find("item");
                                        items.each(function (i) {
                                            var id = $(items[i]).attr("id");
                                            var name = $(items[i]).attr("name");
                                            third.append("<option value='" + id + "'>" + name + "</option>");
                                        });
                                    }, 'xml');

                            });

                        });
                    </script>
                    <select style="width:160px" name="majorChange.newSecondKindId" id="secondKindId" size="1" class="SELECT_STYLE2">
                        <option value="0">-----请选择-----</option>

                    </select>
                    <input type="hidden" name="majorChange.newSecondKindName" id="newSecondKindName">
                </td>
                <td class="TD_STYLE1" width="12%">
                    新三级机构名称
                </td>
                <td class="TD_STYLE2">
                    <select style="width:160px" name="majorChange.newThirdKindId" id="thirdKindId" size="1" class="SELECT_STYLE2">
                        <option value="0">-----请选择-----</option>
                    </select>
                    <input type="hidden" name="majorChange.newThirdKindName" id="newThirdKindName">
                </td>
                <td class="TD_STYLE1" width="8%"></td>
                <td class="TD_STYLE2" width="10%"></td>
            </tr>
            <tr>
                <td class="TD_STYLE1">
                    新职位分类
                </td>
                <td class="TD_STYLE2">
                    <select style="width:160px" name="majorChange.newMajorKindId" id="newMajorKindId" size="1" class="SELECT_STYLE2">
                        <option value="0">-----请选择-----</option>



                    </select>
                    <input type="hidden" name="majorChange.newMajorKindName" id="newMajorKindName">
                    <script type="text/javascript">

                        $(function () {
                            $('#newMajorId').change(function () { $("#newMajorName").val($('#newMajorId option:selected').html()); });
                            var second = $('#newMajorKindId');
                            var third = $('#newMajorId');
                            second.change(function () {
                                $("#newMajorKindName").val($('#newMajorKindId option:selected').html());

                                $.post('/HR_Fist/transfer/transferAction!findMajor.action', { 'majorChange.newMajorKindId': $('#newMajorKindId option:selected').val() },
                                    function (data) {
                                        third.css("width", second.width());
                                        third.empty();
                                        third.append("<option value='0' >-----请选择-----</option>");
                                        var items = $(data).find("item");
                                        items.each(function (i) {
                                            var id = $(items[i]).attr("id");
                                            var name = $(items[i]).attr("name");
                                            third.append("<option value='" + id + "'>" + name + "</option>");


                                        });
                                    }, 'xml');

                            });

                        });
                    </script>
                </td>
                <td class="TD_STYLE1" width="12%">
                    新职位名称
                </td>
                <td class="TD_STYLE2">
                    <select name="majorChange.newMajorId" id="newMajorId" class="INPUT_STYLE2">
                        <option value="0">-----请选择-----</option>
                    </select>
                </td>
                <td class="TD_STYLE1">
                    新薪酬标准
                </td>
                <td class="TD_STYLE2">
                    <select style="width:160px" name="majorChange.newSalaryStandardId" id="newSalaryStandardId" size="1" class="SELECT_STYLE2">
                        <option value="0">-----请选择-----</option>


                    </select>
                    <input type="hidden" name="majorChange.newSalaryStandardName" id="newSalaryStandardName">
                    <SCRIPT type="text/javascript">
                        $(function () {
                            var standardid = $('#newSalaryStandardId');
                            var standardname = $('#newSalaryStandardName');
                            var newSalarySum = $('#newSalarySum');
                            standardid.change(function () {
                                standardname.val($('#newSalaryStandardId option:selected').html());
                                $.post('/HR_Fist/transfer/transferAction!findSalarySum.action', { 'majorChange.newSalaryStandardId': $('#newSalaryStandardId option:selected').val() },
                            function (data) {
                                newSalarySum.val(data);

                            }
                            , 'html');


                            });

                        });
                    </SCRIPT>
                </td>
                <td class="TD_STYLE1">
                    新薪酬总额
                </td>
                <td class="TD_STYLE2">
                    @Html.TextBoxFor(e => e.new_salary_sum, new { @readonly = true })
                </td>
            </tr>

            <tr>
                <td class="TD_STYLE1">
                    登记人
                </td>
                <td class="TD_STYLE2">
                    @Html.TextBoxFor(e => e.register, new { @readonly = true })
                </td>
                <td class="TD_STYLE1">
                    登记时间
                </td>
                <td class="TD_STYLE2">
                    <input type="text" name="majorChange.registTime" readonly="readonly"
                           id="Tdate" class="INPUT_STYLE2">
                    <SCRIPT type="text/javascript">
                        function time() {
                            var tdate = document.getElementById("Tdate");
                            var d = new Date();
                            var y = d.getFullYear();
                            var moth = d.getMonth() + 1;
                            var date = d.getDate();
                            var h = d.getHours();
                            var m = d.getMinutes();
                            var s = d.getSeconds();
                            var hh = 20 - 1 - h;
                            var mm = 60 - 1 - m;
                            var ss = 60 - s;
                            if (hh > 0) {
                                mm = mm + 60 * hh;
                            }
                            if (moth < 10) {
                                moth = "0" + moth;
                            }
                            if (date < 10) {
                                date = "0" + date;
                            }
                            if (h < 10) {
                                h = "0" + h;
                            }
                            if (m < 10) {
                                m = "0" + m;
                            }
                            if (s < 10) {
                                s = "0" + s;
                            }
                            if (mm < 10) {
                                mm = "0" + mm;
                            }
                            if (ss < 10) {
                                ss = "0" + ss;
                            }

                            tdate.value = y + "-" + moth + "-" + date + "- " + h + ":" + m + ":" + s;


                        }
                        window.onload = time;
                        var out = window.setInterval(time, 1000);
                    </SCRIPT>
                </td>
                <td class="TD_STYLE1"></td>
                <td class="TD_STYLE2"></td>
                <td class="TD_STYLE1"></td>
                <td class="TD_STYLE2"></td>
            </tr>
            <tr>
                <td class="TD_STYLE1">
                    调动原因
                </td>
                <td colspan="7" class="TD_STYLE2">
                    @Html.TextAreaFor(e => e.salary_standard_name, new { @readonly = true, @style = "width:1260px;height:70px;" })

                </td>
            </tr>
        </table>
    </form>
</body>
</html>
